<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Introduction to Time Series</title>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
  <meta name="description" content="Introduction to Time Series">
  <meta name="generator" content="bookdown 0.1.4 and GitBook 2.6.7">

  <meta property="og:title" content="Introduction to Time Series" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://coatless.github.io/its/" />
  
  
  <meta name="github-repo" content="coatless/its" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Introduction to Time Series" />
  
  
  

<meta name="author" content="James Balamuta and Stephane Guerrier">

<meta name="date" content="2016-08-14">

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="autocorrelation-and-stationarity.html">
<link rel="next" href="arma.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>


  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Introduction to Time Series</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#a-foreword"><i class="fa fa-check"></i><b>1.1</b> A foreword</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#rendering-mathematical-formulae"><i class="fa fa-check"></i><b>1.2</b> Rendering Mathematical Formulae</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#mathematical-notation"><i class="fa fa-check"></i><b>1.3</b> Mathematical Notation</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#r-code-conventions"><i class="fa fa-check"></i><b>1.4</b> R Code Conventions</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#license"><i class="fa fa-check"></i><b>1.5</b> License</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="the-world-of-time-series.html"><a href="the-world-of-time-series.html"><i class="fa fa-check"></i><b>2</b> The World of Time Series</a><ul>
<li class="chapter" data-level="2.1" data-path="the-world-of-time-series.html"><a href="the-world-of-time-series.html#objective-of-time-series"><i class="fa fa-check"></i><b>2.1</b> Objective of Time Series</a></li>
<li class="chapter" data-level="2.2" data-path="the-world-of-time-series.html"><a href="the-world-of-time-series.html#what-is-a-time-series-and-can-i-eat-it"><i class="fa fa-check"></i><b>2.2</b> What is a Time Series and can I eat it?</a></li>
<li class="chapter" data-level="2.3" data-path="the-world-of-time-series.html"><a href="the-world-of-time-series.html#exploratory-data-analysis-eda-for-time-series"><i class="fa fa-check"></i><b>2.3</b> Exploratory Data Analysis (EDA) for Time Series</a><ul>
<li class="chapter" data-level="2.3.1" data-path="the-world-of-time-series.html"><a href="the-world-of-time-series.html#identifying-trends"><i class="fa fa-check"></i><b>2.3.1</b> Identifying Trends</a></li>
<li class="chapter" data-level="2.3.2" data-path="the-world-of-time-series.html"><a href="the-world-of-time-series.html#noticing-changes-in-time-and-outliers"><i class="fa fa-check"></i><b>2.3.2</b> Noticing changes in time and outliers</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="autocorrelation-and-stationarity.html"><a href="autocorrelation-and-stationarity.html"><i class="fa fa-check"></i><b>3</b> Autocorrelation and Stationarity</a><ul>
<li class="chapter" data-level="3.1" data-path="autocorrelation-and-stationarity.html"><a href="autocorrelation-and-stationarity.html#dependency"><i class="fa fa-check"></i><b>3.1</b> Dependency</a><ul>
<li class="chapter" data-level="3.1.1" data-path="autocorrelation-and-stationarity.html"><a href="autocorrelation-and-stationarity.html#measuring-linear-dependence"><i class="fa fa-check"></i><b>3.1.1</b> Measuring (Linear) Dependence</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="autocorrelation-and-stationarity.html"><a href="autocorrelation-and-stationarity.html#stationarity"><i class="fa fa-check"></i><b>3.2</b> Stationarity</a><ul>
<li class="chapter" data-level="3.2.1" data-path="autocorrelation-and-stationarity.html"><a href="autocorrelation-and-stationarity.html#weak-stationarity"><i class="fa fa-check"></i><b>3.2.1</b> Weak Stationarity</a></li>
<li class="chapter" data-level="3.2.2" data-path="autocorrelation-and-stationarity.html"><a href="autocorrelation-and-stationarity.html#strong-stationarity"><i class="fa fa-check"></i><b>3.2.2</b> Strong Stationarity</a></li>
<li class="chapter" data-level="3.2.3" data-path="autocorrelation-and-stationarity.html"><a href="autocorrelation-and-stationarity.html#is-it-weakly-stationary"><i class="fa fa-check"></i><b>3.2.3</b> Is it weakly stationary?</a></li>
<li class="chapter" data-level="3.2.4" data-path="autocorrelation-and-stationarity.html"><a href="autocorrelation-and-stationarity.html#is-a-random-walk-weakly-stationary"><i class="fa fa-check"></i><b>3.2.4</b> Is a random walk weakly stationary?</a></li>
<li class="chapter" data-level="3.2.5" data-path="autocorrelation-and-stationarity.html"><a href="autocorrelation-and-stationarity.html#is-an-ma1-stationary"><i class="fa fa-check"></i><b>3.2.5</b> Is an MA(1) Stationary?</a></li>
<li class="chapter" data-level="3.2.6" data-path="autocorrelation-and-stationarity.html"><a href="autocorrelation-and-stationarity.html#is-an-ar1-stationary"><i class="fa fa-check"></i><b>3.2.6</b> Is an AR(1) Stationary?</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="autocorrelation-and-stationarity.html"><a href="autocorrelation-and-stationarity.html#joint-stationarity"><i class="fa fa-check"></i><b>3.3</b> Joint Stationarity</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="basic-models.html"><a href="basic-models.html"><i class="fa fa-check"></i><b>4</b> Basic Models</a><ul>
<li class="chapter" data-level="4.1" data-path="basic-models.html"><a href="basic-models.html#the-backshift-operator"><i class="fa fa-check"></i><b>4.1</b> The Backshift Operator</a></li>
<li class="chapter" data-level="4.2" data-path="basic-models.html"><a href="basic-models.html#white-noise"><i class="fa fa-check"></i><b>4.2</b> White Noise</a></li>
<li class="chapter" data-level="4.3" data-path="basic-models.html"><a href="basic-models.html#moving-average-process-of-order-q-1-a.k.a-ma1"><i class="fa fa-check"></i><b>4.3</b> Moving Average Process of Order q = 1 a.k.a MA(1)</a></li>
<li class="chapter" data-level="4.4" data-path="basic-models.html"><a href="basic-models.html#drift"><i class="fa fa-check"></i><b>4.4</b> Drift</a></li>
<li class="chapter" data-level="4.5" data-path="basic-models.html"><a href="basic-models.html#random-walk"><i class="fa fa-check"></i><b>4.5</b> Random Walk</a></li>
<li class="chapter" data-level="4.6" data-path="basic-models.html"><a href="basic-models.html#random-walk-with-drift"><i class="fa fa-check"></i><b>4.6</b> Random Walk with Drift</a></li>
<li class="chapter" data-level="4.7" data-path="basic-models.html"><a href="basic-models.html#autoregressive-process-of-order-p-1-a.k.a-ar1"><i class="fa fa-check"></i><b>4.7</b> Autoregressive Process of Order p = 1 a.k.a AR(1)</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="arma.html"><a href="arma.html"><i class="fa fa-check"></i><b>5</b> ARMA</a><ul>
<li class="chapter" data-level="5.1" data-path="arma.html"><a href="arma.html#definition"><i class="fa fa-check"></i><b>5.1</b> Definition</a></li>
<li class="chapter" data-level="5.2" data-path="arma.html"><a href="arma.html#ma-ar-operators"><i class="fa fa-check"></i><b>5.2</b> MA / AR Operators</a></li>
<li class="chapter" data-level="5.3" data-path="arma.html"><a href="arma.html#redundancy"><i class="fa fa-check"></i><b>5.3</b> Redundancy</a></li>
<li class="chapter" data-level="5.4" data-path="arma.html"><a href="arma.html#causal-invertible"><i class="fa fa-check"></i><b>5.4</b> Causal + Invertible</a></li>
<li class="chapter" data-level="5.5" data-path="arma.html"><a href="arma.html#prediction-forecast"><i class="fa fa-check"></i><b>5.5</b> Prediction (Forecast)</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/coatless/its" target="blank">&copy; 2016 James Balamuta</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to Time Series</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="basic-models" class="section level1">
<h1><span class="header-section-number">Chapter 4</span> Basic Models</h1>
<div id="the-backshift-operator" class="section level2">
<h2><span class="header-section-number">4.1</span> The Backshift Operator</h2>
<p><em>Definition:</em> <strong>Backshift Operator</strong></p>
<p>The <strong>Backshift Operator</strong> is helpful when manipulating time series. When we backshift, we are changing the indices of the time series. e.g. <span class="math inline">\(t \rightarrow t-1\)</span>. The operator is defined as:</p>
<p><span class="math display">\[B{x_t} = {x_{t - 1}}\]</span></p>
<p>If we were to repeatedly apply the backshift operator, we would receive:</p>
<p><span class="math display">\[\begin{aligned}
  {B^2}{x_t} &amp;= B\left( {B{x_t}} \right) \\
   &amp;= B\left( {{x_{t - 1}}} \right) \\
   &amp;= {x_{t - 2}} \\ 
\end{aligned}\]</span></p>
<p>We can generalize this behavior as: <span class="math display">\[{B^k}{x_t} = {x_{t - k}}\]</span></p>
<p>The backshift operator is helpful for later decompositions in addition to making differencing operations more straightforward.</p>
</div>
<div id="white-noise" class="section level2">
<h2><span class="header-section-number">4.2</span> White Noise</h2>
<p>The process name of white noise has meaning in the notion of colors of noise. Specifically, the white noise is a process that mirrors white light’s flat frequency spectrum. So, the process has equal frequencies in any interval of time.</p>
<p><em>Definition:</em> <strong>White Noise</strong></p>
<p><span class="math inline">\(w_t\)</span> or <span class="math inline">\(\varepsilon _t\)</span> is a <strong>white noise process</strong> if <span class="math inline">\(w_t\)</span> are uncorrelated identically distributed random variables with <span class="math inline">\(E\left[w_t\right] = 0\)</span> and <span class="math inline">\(Var\left[w_t\right] = \sigma ^2\)</span>, for all <span class="math inline">\(t\)</span>. We can represent this algebraically as: <span class="math display">\[y_t = w_t,\]</span> where <span class="math inline">\({w_t}\mathop \sim \limits^{id} WN\left( {0,\sigma _w^2} \right)\)</span></p>
<p>Now, if the <span class="math inline">\(w_t\)</span> are <strong>Normally (Gaussian) distributed</strong>, then the process is known as a <strong>Gaussian White Noise</strong> e.g. <span class="math inline">\({w_t}\mathop \sim \limits^{iid} N\left( {0,{\sigma ^2}} \right)\)</span></p>
<p>To generate gaussian white noise use:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1336</span>)          <span class="co"># Set seed to reproduce the results</span>
n  =<span class="st"> </span><span class="dv">200</span>                <span class="co"># Number of observations to generate</span>
wn =<span class="st"> </span><span class="kw">ts</span>(<span class="kw">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>))   <span class="co"># Generate Guassian white noise.</span>

<span class="kw">autoplot</span>(wn) +
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;White Noise Process&quot;</span>) +
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Displacement&quot;</span>) +<span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Time (seconds)&quot;</span>)</code></pre></div>
<p><img src="its_files/figure-html/generate_white_noise-1.png" width="672" /></p>
</div>
<div id="moving-average-process-of-order-q-1-a.k.a-ma1" class="section level2">
<h2><span class="header-section-number">4.3</span> Moving Average Process of Order q = 1 a.k.a MA(1)</h2>
<p><em>Definition:</em> <strong>Moving Average Process of Order (q = 1)</strong></p>
<p>The concept of a <strong>Moving Average Process of Order q</strong> is a way to remove “noise” and emphasize the signal. The moving average achieves this by taking the local averages of the data to produce a new smoother time series series. The newly created time series is more descriptive, but it does influence the dependence within the time series.</p>
<p>This process is generally denoted as <strong>MA(1)</strong> and is defined as:</p>
<p><span class="math display">\[{y_t} = {\theta _1}{w_{t - 1}} + {w_t},\]</span></p>
<p>where <span class="math inline">\({w_t}\mathop \sim \limits^{iid} WN\left( {0,\sigma _w^2} \right)\)</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1345</span>)  <span class="co"># Set seed to reproduce the results</span>
n      =<span class="st"> </span><span class="dv">200</span>    <span class="co"># Number of observations to generate</span>
sigma2 =<span class="st"> </span><span class="dv">2</span>      <span class="co"># Controls variance of Guassian white noise.</span>
theta  =<span class="st"> </span><span class="fl">0.3</span>    <span class="co"># Handles the theta component of MA(1)</span>


<span class="co"># Generate a white noise</span>
wn =<span class="st"> </span><span class="kw">rnorm</span>(n<span class="dv">+1</span>, <span class="dt">sd =</span> <span class="kw">sqrt</span>(sigma2))

<span class="co"># Simulate the MA(1) process</span>
ma =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, n<span class="dv">+1</span>)
for(i in <span class="dv">2</span>:(n<span class="dv">+1</span>)) {     
  ma[i] =<span class="st"> </span>theta*wn[i<span class="dv">-1</span>] +<span class="st"> </span>wn[i]
}

ma =<span class="st"> </span><span class="kw">ts</span>(ma[<span class="dv">2</span>:(n<span class="dv">+1</span>)])     <span class="co"># Remove first item</span>

<span class="kw">autoplot</span>(ma) +
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Moving Average Order 1 Process&quot;</span>) +
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Displacement&quot;</span>) +<span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Time (seconds)&quot;</span>)</code></pre></div>
<p><img src="its_files/figure-html/generate_ma1-1.png" width="672" /></p>
</div>
<div id="drift" class="section level2">
<h2><span class="header-section-number">4.4</span> Drift</h2>
<p><em>Definition:</em> <strong>Drift</strong></p>
<p>A <strong>drift process</strong> has two components: time and a slope. As more points are accumlated over time, the drift will match the common slope form.</p>
<p>Specifically, the drift process has the following form: <span class="math display">\[y_t = y_{t-1} + \delta \]</span> with the initial condition <span class="math inline">\(y_0 = c\)</span>.</p>
<p>The process can be simplified using <strong>backsubstitution</strong> to being: <span class="math display">\[\begin{aligned}
  {y_t} &amp;= {y_{t - 1}} + \delta \\
   &amp;= \left( {{y_{t - 2}} + \delta} \right) + \delta \\
   &amp;\vdots  \\
   &amp;= \sum\limits_{i = 1}^t {\delta}  + y_0 \\ 
   {y_t} &amp;= t{\delta} + c  \\ 
\end{aligned} \]</span></p>
<p>Again, note that a drift is similar to the slope-intercept form a linear line. e.g. <span class="math inline">\(y = mx + b\)</span>.</p>
<p>To generate a drift use:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n     =<span class="st"> </span><span class="dv">200</span>             <span class="co"># Number of observations to generate</span>
drift =<span class="st"> </span>.<span class="dv">3</span>              <span class="co"># Drift Control</span>
dr    =<span class="st"> </span><span class="kw">ts</span>(drift*(<span class="dv">1</span>:n)) <span class="co"># Generate drift sequence (e.g. y = drift*x + 0)</span>

<span class="kw">autoplot</span>(dr) +
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Drift Process&quot;</span>) +
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Displacement&quot;</span>) +<span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Time (seconds)&quot;</span>)</code></pre></div>
<p><img src="its_files/figure-html/generate_drift-1.png" width="672" /></p>
</div>
<div id="random-walk" class="section level2">
<h2><span class="header-section-number">4.5</span> Random Walk</h2>
<p>In 1906, Karl Pearson coined the term ‘random walk’ and demonstrated that “the most likely place to find a drunken walker is somewhere near his starting point.” Empirical evidence of this phenomenon is not too hard to find on a Friday night in Champaign.</p>
<p><em>Definition:</em> <strong>Random Walk</strong></p>
<p>A <strong>random walk</strong> is defined as a process where the current value of a variable is composed of the past value plus an error term that is a white noise. In algebraic form, <span class="math display">\[y_t = y_{t-1} + w_t\]</span> with the initial condition <span class="math inline">\(y_0 = c\)</span>.</p>
<p>The process can be simplified using <strong>backsubstitution</strong> to being: <span class="math display">\[\begin{aligned}
  {y_t} &amp;= {y_{t - 1}} + {w_t} \\
   &amp;= \left( {{y_{t - 2}} + {w_{t - 1}}} \right) + {w_t} \\
   &amp;\vdots  \\
  {y_t} &amp;= \sum\limits_{i = 1}^t {{w_i}} + y_0 =  \sum\limits_{i = 1}^t {{w_i}} + c \\ 
\end{aligned} \]</span></p>
<p>To generate a random walk, we use:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1336</span>)       <span class="co"># Set seed to reproduce the results</span>
n  =<span class="st"> </span><span class="dv">200</span>             <span class="co"># Number of observations to generate</span>
w  =<span class="st"> </span><span class="kw">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)    <span class="co"># Generate Guassian white noise.</span>
rw =<span class="st"> </span><span class="kw">ts</span>(<span class="kw">cumsum</span>(w))   <span class="co"># Cumulative sum</span>

<span class="co"># Create a data.frame to graph in ggplot2</span>
<span class="kw">autoplot</span>(rw) +
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Random Walk&quot;</span>) +
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Displacement&quot;</span>) +<span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Time (seconds)&quot;</span>)</code></pre></div>
<p><img src="its_files/figure-html/generate_rw-1.png" width="672" /></p>
</div>
<div id="random-walk-with-drift" class="section level2">
<h2><span class="header-section-number">4.6</span> Random Walk with Drift</h2>
<p>In the previous case of a random walk, we assumed that drift, <span class="math inline">\(\delta\)</span>, was equal to 0. What happens to the random walk if the drift is not equal to zero? That is, what happens with the initial condition <span class="math inline">\(y_0 = c\)</span>?</p>
<p><span class="math display">\[\begin{aligned}
  {y_t} &amp;= {y_{t - 1}} + {w_t} + \delta \\
   &amp;= \left( {{y_{t - 2}} + {w_{t - 1}} + \delta} \right) + {w_t} + \delta \\
   &amp;\vdots  \\
  {y_t} &amp;= \sum\limits_{i = 1}^t {\left({w_{i} + \delta}\right)} + y_0 =  \sum\limits_{i = 1}^t {{w_i}} + t\delta + c \\ 
\end{aligned} \]</span></p>
<p>To generate a random walk with drift we use:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1336</span>)       <span class="co"># Set seed to reproduce the results</span>
n     =<span class="st"> </span><span class="dv">200</span>          <span class="co"># Number of observations to generate</span>
drift =<span class="st"> </span>.<span class="dv">3</span>           <span class="co"># Drift Control</span>

w =<span class="st"> </span><span class="kw">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)     <span class="co"># Generate Guassian white noise.</span>
wd =<span class="st"> </span>w +<span class="st"> </span>drift       <span class="co"># Add a drift</span>
rwd =<span class="st"> </span><span class="kw">ts</span>(<span class="kw">cumsum</span>(wd)) <span class="co"># Cumulative sum</span>

<span class="co"># Create a data.frame to graph in ggplot2</span>
<span class="kw">autoplot</span>(rwd) +<span class="st"> </span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Random Walk with Drift&quot;</span>) +
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Displacement&quot;</span>) +<span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Time (seconds)&quot;</span>)</code></pre></div>
<p><img src="its_files/figure-html/generate_rwd-1.png" width="672" /></p>
<p>Notice the difference the drift makes upon the random walk:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Add identifiers</span>
drift.df =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Index =</span> <span class="dv">1</span>:n, <span class="dt">Data =</span> drift*(<span class="dv">1</span>:n), <span class="dt">Type =</span> <span class="st">&quot;Drift&quot;</span>)

rw.df =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Index =</span> <span class="dv">1</span>:n, <span class="dt">Data =</span> rw, <span class="dt">Type =</span> <span class="st">&quot;Random Walk&quot;</span>)

rwd.df =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Index =</span> <span class="dv">1</span>:n, <span class="dt">Data =</span> rwd, <span class="dt">Type =</span> <span class="st">&quot;Random Walk with Drift&quot;</span>)

combined.df =<span class="st"> </span><span class="kw">rbind</span>(drift.df, rw.df, rwd.df)

<span class="kw">ggplot</span>(<span class="dt">data =</span> combined.df, <span class="kw">aes</span>(<span class="dt">x =</span> Index, <span class="dt">y =</span> Data, <span class="dt">colour =</span> Type)) +
<span class="st">  </span><span class="kw">geom_line</span>() +
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Comparisons of Random Walk&quot;</span>) +
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Displacement&quot;</span>) +<span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Time (seconds)&quot;</span>)</code></pre></div>
<p><img src="its_files/figure-html/compare_rw_and_rwd-1.png" width="672" /></p>
</div>
<div id="autoregressive-process-of-order-p-1-a.k.a-ar1" class="section level2">
<h2><span class="header-section-number">4.7</span> Autoregressive Process of Order p = 1 a.k.a AR(1)</h2>
<p><em>Definition:</em> <strong>Autoregressive Process of Order p = 1</strong></p>
<p>This process is generally denoted as <strong>AR(1)</strong> and is defined as: <span class="math inline">\({y_t} = {\phi _1}{y_{t - 1}} + {w_t},\)</span></p>
<p>where <span class="math inline">\({w_t}\mathop \sim \limits^{iid} WN\left( {0,\sigma _w^2} \right)\)</span></p>
<p>If <span class="math inline">\(\phi _1 = 1\)</span>, then the process is equivalent to a random walk.</p>
<p>The process can be simplified using <strong>backsubstitution</strong> to being: <span class="math display">\[\begin{aligned}
 {y_t} &amp;= {\phi _t}{y_{t - 1}} + {w_t} \\
   &amp;= {\phi _1}\left( {{\phi _1}{y_{t - 2}} + {w_{t - 1}}} \right) + {w_t} \\
   &amp;= \phi _1^2{y_{t - 2}} + {\phi _1}{w_{t - 1}} + {w_t} \\
   &amp;\vdots  \\
   &amp;= {\phi ^t}{y_0} + \sum\limits_{i = 0}^{t - 1} {\phi _1^i{w_{t - i}}}
\end{aligned}\]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1345</span>)  <span class="co"># Set seed to reproduce the results</span>
n      =<span class="st"> </span><span class="dv">200</span>    <span class="co"># Number of observations to generate</span>
sigma2 =<span class="st"> </span><span class="dv">2</span>      <span class="co"># Controls variance of Guassian white noise.</span>
phi    =<span class="st"> </span><span class="fl">0.3</span>    <span class="co"># Handles the phi component of AR(1)</span>

wn =<span class="st"> </span><span class="kw">rnorm</span>(n<span class="dv">+1</span>, <span class="dt">sd =</span> <span class="kw">sqrt</span>(sigma2))

<span class="co"># Simulate the MA(1) process</span>
ar =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,n<span class="dv">+1</span>)
for(i in <span class="dv">2</span>:n) {     
  ar[i] =<span class="st"> </span>phi*ar[i<span class="dv">-1</span>] +<span class="st"> </span>wn[i]
}

ar =<span class="st"> </span><span class="kw">ts</span>(ar[<span class="dv">2</span>:(n<span class="dv">+1</span>)])

<span class="kw">autoplot</span>(ar) +
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Autoregressive Order 1 Process&quot;</span>) +
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Displacement&quot;</span>) +<span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Time (seconds)&quot;</span>)</code></pre></div>
<p><img src="its_files/figure-html/generate_ar1-1.png" width="672" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="autocorrelation-and-stationarity.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="arma.html" class="navigation navigation-next " aria-label="Next page""><i class="fa fa-angle-right"></i></a>

<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/coatless/its/edit/master/03-basic-models.Rmd",
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
